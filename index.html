<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>제주교육청 스마트단말 관리 시스템</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/firebase@9.23.0/firebase-app-compat.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/firebase@9.23.0/firebase-database-compat.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8fafc;
            color: #334155;
            line-height: 1.6;
        }

        /* 블루&화이트&그레이 색상 테마 */
        :root {
            --primary-blue: #3b82f6;
            --dark-blue: #1e40af;
            --light-blue: #dbeafe;
            --gray-50: #f8fafc;
            --gray-100: #f1f5f9;
            --gray-200: #e2e8f0;
            --gray-300: #cbd5e1;
            --gray-400: #94a3b8;
            --gray-500: #64748b;
            --gray-600: #475569;
            --gray-700: #334155;
            --gray-800: #1e293b;
            --white: #ffffff;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
        }

        /* 로그인 화면 */
        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--dark-blue) 100%);
        }

        .login-card {
            background: var(--white);
            padding: 3rem;
            border-radius: 12px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }

        .logo {
            width: 80px;
            height: 80px;
            margin: 0 auto 1.5rem;
            background: var(--primary-blue);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 2rem;
        }

        .login-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--gray-800);
            margin-bottom: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
            text-align: left;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--gray-700);
        }

        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid var(--gray-200);
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-blue);
        }

        .login-btn {
            width: 100%;
            padding: 0.75rem;
            background: var(--primary-blue);
            color: var(--white);
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .login-btn:hover {
            background: var(--dark-blue);
        }

        .contact-info {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--gray-200);
            color: var(--gray-500);
            font-size: 0.875rem;
        }

        /* 메인 레이아웃 */
        .main-container {
            display: none;
            min-height: 100vh;
        }

        .sidebar {
            width: 280px;
            background: var(--gray-800);
            color: var(--white);
            position: fixed;
            height: 100vh;
            left: 0;
            top: 0;
            z-index: 1000;
            overflow-y: auto;
        }

        .sidebar-header {
            padding: 1.5rem;
            background: var(--gray-700);
            border-bottom: 1px solid var(--gray-600);
        }

        .sidebar-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .sidebar-subtitle {
            font-size: 0.875rem;
            color: var(--gray-400);
            margin-top: 0.25rem;
        }

        .sidebar-nav {
            padding: 1rem 0;
        }

        .nav-item {
            display: block;
            padding: 0.75rem 1.5rem;
            color: var(--gray-300);
            text-decoration: none;
            transition: all 0.3s;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            cursor: pointer;
        }

        .nav-item:hover,
        .nav-item.active {
            background: var(--primary-blue);
            color: var(--white);
        }

        .nav-item i {
            width: 20px;
            margin-right: 0.75rem;
        }

        .logout-btn {
            position: absolute;
            bottom: 1rem;
            left: 1rem;
            right: 1rem;
            padding: 0.75rem;
            background: var(--danger);
            color: var(--white);
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .logout-btn:hover {
            background: #dc2626;
        }

        .content {
            margin-left: 280px;
            padding: 2rem;
            min-height: 100vh;
            background: var(--gray-50);
        }

        .content-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 2rem;
            background: var(--white);
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .page-title {
            font-size: 1.875rem;
            font-weight: 600;
            color: var(--gray-800);
        }

        .user-info {
            color: var(--gray-500);
            font-size: 0.875rem;
        }

        /* 대시보드 카드 */
        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .dashboard-card {
            background: var(--white);
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border-left: 4px solid var(--primary-blue);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .card-title {
            color: var(--gray-600);
            font-size: 0.875rem;
            font-weight: 500;
        }

        .card-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 1.25rem;
        }

        .card-icon.blue { background: var(--primary-blue); }
        .card-icon.green { background: var(--success); }
        .card-icon.yellow { background: var(--warning); }
        .card-icon.red { background: var(--danger); }

        .card-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--gray-800);
        }

        /* 컨트롤 패널 */
        .controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .search-controls {
            display: flex;
            gap: 1rem;
            flex: 1;
            flex-wrap: wrap;
        }

        .search-input {
            flex: 1;
            min-width: 200px;
            padding: 0.75rem;
            border: 2px solid var(--gray-200);
            border-radius: 8px;
            font-size: 0.875rem;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary-blue);
        }

        .select-input {
            padding: 0.75rem;
            border: 2px solid var(--gray-200);
            border-radius: 8px;
            background: var(--white);
            font-size: 0.875rem;
            min-width: 150px;
        }

        .date-input {
            padding: 0.75rem;
            border: 2px solid var(--gray-200);
            border-radius: 8px;
            font-size: 0.875rem;
        }

        /* 버튼 스타일 */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }

        .btn-primary {
            background: var(--primary-blue);
            color: var(--white);
        }

        .btn-primary:hover {
            background: var(--dark-blue);
        }

        .btn-success {
            background: var(--success);
            color: var(--white);
        }

        .btn-success:hover {
            background: #059669;
        }

        .btn-warning {
            background: var(--warning);
            color: var(--white);
        }

        .btn-warning:hover {
            background: #d97706;
        }

        .btn-danger {
            background: var(--danger);
            color: var(--white);
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-secondary {
            background: var(--gray-500);
            color: var(--white);
        }

        .btn-secondary:hover {
            background: var(--gray-600);
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.75rem;
        }

        /* 테이블 */
        .table-container {
            background: var(--white);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th {
            background: var(--primary-blue);
            color: var(--white);
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            font-size: 0.875rem;
        }

        .table td {
            padding: 1rem;
            border-bottom: 1px solid var(--gray-200);
            font-size: 0.875rem;
        }

        .table tr:hover {
            background: var(--gray-50);
        }

        .table tr:last-child td {
            border-bottom: none;
        }

        /* 페이지네이션 */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .pagination-btn {
            padding: 0.5rem 1rem;
            border: 2px solid var(--gray-200);
            background: var(--white);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .pagination-btn:hover:not(:disabled) {
            border-color: var(--primary-blue);
            color: var(--primary-blue);
        }

        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .pagination-input {
            width: 60px;
            padding: 0.5rem;
            border: 2px solid var(--gray-200);
            border-radius: 6px;
            text-align: center;
        }

        .pagination-info {
            color: var(--gray-600);
            font-size: 0.875rem;
        }

        /* 모달 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            overflow-y: auto;
        }

        .modal-content {
            background: var(--white);
            margin: 2rem auto;
            padding: 0;
            border-radius: 12px;
            width: 90%;
            max-width: 800px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            position: relative;
        }

        .modal-header {
            padding: 1.5rem;
            background: var(--primary-blue);
            color: var(--white);
            border-radius: 12px 12px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--white);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background-color 0.3s;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid var(--gray-200);
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        /* 폼 그리드 */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--gray-700);
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid var(--gray-200);
            border-radius: 8px;
            font-size: 0.875rem;
            transition: border-color 0.3s;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--primary-blue);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        /* 상태 배지 */
        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .status-badge.rental {
            background: var(--danger);
            color: var(--white);
        }

        .status-badge.available {
            background: var(--success);
            color: var(--white);
        }

        /* 프로그레스 바 */
        .progress-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 3000;
        }

        .progress-content {
            background: var(--white);
            padding: 2rem;
            border-radius: 12px;
            text-align: center;
            min-width: 300px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--gray-200);
            border-radius: 4px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary-blue);
            width: 0%;
            transition: width 0.3s;
        }

        .progress-text {
            font-weight: 500;
            color: var(--gray-700);
            margin-bottom: 0.5rem;
        }

        .progress-percentage {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--primary-blue);
        }

        /* 반응형 */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s;
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .content {
                margin-left: 0;
            }

            .mobile-toggle {
                display: block;
                position: fixed;
                top: 1rem;
                left: 1rem;
                z-index: 1001;
                background: var(--primary-blue);
                color: var(--white);
                border: none;
                padding: 0.75rem;
                border-radius: 8px;
                cursor: pointer;
            }

            .dashboard-cards {
                grid-template-columns: 1fr;
            }

            .controls {
                flex-direction: column;
            }

            .search-controls {
                flex-direction: column;
            }

            .modal-content {
                margin: 1rem;
                width: calc(100% - 2rem);
            }
        }

        .mobile-toggle {
            display: none;
        }

        /* 알림 스타일 */
        .alert {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            border: 1px solid;
        }

        .alert-success {
            background: #d1fae5;
            border-color: #10b981;
            color: #064e3b;
        }

        .alert-error {
            background: #fee2e2;
            border-color: #ef4444;
            color: #7f1d1d;
        }

        .alert-warning {
            background: #fef3c7;
            border-color: #f59e0b;
            color: #78350f;
        }

        /* 링크 스타일 */
        .link {
            color: var(--primary-blue);
            text-decoration: none;
            cursor: pointer;
        }

        .link:hover {
            text-decoration: underline;
        }

        /* 체크박스 스타일 */
        .checkbox {
            width: 18px;
            height: 18px;
            accent-color: var(--primary-blue);
        }

        /* 숨김 클래스 */
        .hidden {
            display: none !important;
        }

        /* 로딩 스피너 */
        .spinner {
            border: 3px solid var(--gray-200);
            border-top: 3px solid var(--primary-blue);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- 모바일 토글 버튼 -->
    <button class="mobile-toggle" id="mobileToggle">
        <i class="fas fa-bars"></i>
    </button>

    <!-- 로그인 화면 -->
    <div class="login-container" id="loginContainer">
        <div class="login-card">
            <div class="logo">
                <i class="fas fa-graduation-cap"></i>
            </div>
            <h1 class="login-title">제주교육청 스마트단말 관리 시스템</h1>
            <form id="loginForm">
                <div class="form-group">
                    <label class="form-label" for="username">아이디</label>
                    <input type="text" class="form-input" id="username" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="password">비밀번호</label>
                    <input type="password" class="form-input" id="password" required>
                </div>
                <button type="submit" class="login-btn">로그인</button>
            </form>
            <div class="contact-info">
                <p><strong>콜센터 번호: 1811-8290</strong></p>
                <p>제주특별자치도교육청</p>
            </div>
        </div>
    </div>

    <!-- 메인 시스템 -->
    <div class="main-container" id="mainContainer">
        <!-- 사이드바 -->
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-title">제주교육청</div>
                <div class="sidebar-subtitle">스마트단말 관리</div>
            </div>
            <div class="sidebar-nav">
                <button class="nav-item active" data-page="dashboard">
                    <i class="fas fa-tachometer-alt"></i> 대여 관리
                </button>
                <button class="nav-item" data-page="products">
                    <i class="fas fa-box"></i> 제품 관리
                </button>
                <button class="nav-item" data-page="users">
                    <i class="fas fa-users"></i> 사용자 관리
                </button>
                <button class="nav-item" data-page="feedback">
                    <i class="fas fa-comments"></i> 피드백 게시판
                </button>
            </div>
            <button class="logout-btn" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i> 로그아웃
            </button>
        </nav>

        <!-- 메인 콘텐츠 -->
        <main class="content">
            <!-- 헤더 -->
            <div class="content-header">
                <h1 class="page-title" id="pageTitle">대여 관리</h1>
                <div class="user-info" id="userInfo">
                    관리자님 환영합니다! | <span id="currentTime"></span>
                </div>
            </div>

            <!-- 대여 관리 페이지 -->
            <div id="dashboardPage" class="page-content">
                <div class="dashboard-cards">
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">1차 장비 수</div>
                            <div class="card-icon blue">
                                <i class="fas fa-laptop"></i>
                            </div>
                        </div>
                        <div class="card-value" id="phase1Count">0</div>
                    </div>
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">2차 장비 수</div>
                            <div class="card-icon green">
                                <i class="fas fa-tablet-alt"></i>
                            </div>
                        </div>
                        <div class="card-value" id="phase2Count">0</div>
                    </div>
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">대여중</div>
                            <div class="card-icon yellow">
                                <i class="fas fa-hand-holding"></i>
                            </div>
                        </div>
                        <div class="card-value" id="rentalCount">0</div>
                    </div>
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-title">미 대여중</div>
                            <div class="card-icon red">
                                <i class="fas fa-exclamation-triangle"></i>
                            </div>
                        </div>
                        <div class="card-value" id="availableCount">0</div>
                    </div>
                </div>

                <div class="controls">
                    <div class="search-controls">
                        <input type="text" class="search-input" id="searchInput" placeholder="관리번호, 학교명, 학생명, 제품명 검색...">
                        <select class="select-input" id="statusFilter">
                            <option value="">전체 상태</option>
                            <option value="대여중">대여중</option>
                            <option value="미 대여중">미 대여중</option>
                        </select>
                        <select class="select-input" id="phaseFilter">
                            <option value="">전체 차수</option>
                            <option value="1차">1차</option>
                            <option value="2차">2차</option>
                        </select>
                        <select class="select-input" id="modelFilter">
                            <option value="">전체 모델</option>
                        </select>
                    </div>
                    <div class="controls">
                        <input type="date" class="date-input" id="startDate" placeholder="시작일">
                        <input type="date" class="date-input" id="endDate" placeholder="종료일">
                        <button class="btn btn-primary" id="searchBtn">
                            <i class="fas fa-search"></i> 검색
                        </button>
                        <button class="btn btn-secondary" id="resetBtn">
                            <i class="fas fa-undo"></i> 초기화
                        </button>
                    </div>
                </div>

                <div class="controls">
                    <button class="btn btn-success" id="addRentalBtn">
                        <i class="fas fa-plus"></i> 새 대여 추가
                    </button>
                    <button class="btn btn-primary" id="downloadRentalSampleBtn">
                        <i class="fas fa-download"></i> Excel 샘플
                    </button>
                    <button class="btn btn-warning" id="uploadRentalBtn">
                        <i class="fas fa-upload"></i> Excel 업로드
                    </button>
                    <button class="btn btn-danger" id="deleteAllRentalsBtn">
                        <i class="fas fa-trash-alt"></i> 전체 삭제
                    </button>
                </div>

                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th><input type="checkbox" class="checkbox" id="selectAllRentals"></th>
                                <th>순번</th>
                                <th>관리번호</th>
                                <th>제품시리얼</th>
                                <th>학교명</th>
                                <th>학교급</th>
                                <th>학생명</th>
                                <th>제품명</th>
                                <th>상태</th>
                                <th>메모1</th>
                                <th>메모2</th>
                                <th>작업</th>
                            </tr>
                        </thead>
                        <tbody id="rentalTableBody"></tbody>
                    </table>
                </div>

                <div class="pagination">
                    <button class="pagination-btn" id="prevRentalPage">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <input type="number" class="pagination-input" id="currentRentalPage" value="1" min="1">
                    <span class="pagination-info">/ <span id="totalRentalPages">1</span></span>
                    <button class="pagination-btn" id="nextRentalPage">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>

            <!-- 제품 관리 페이지 -->
            <div id="productsPage" class="page-content hidden">
                <div class="controls">
                    <input type="text" class="search-input" id="productSearchInput" placeholder="차수, 관리번호, 제품명, 시리얼 검색...">
                    <button class="btn btn-primary" id="productSearchBtn">
                        <i class="fas fa-search"></i> 검색
                    </button>
                    <button class="btn btn-secondary" id="productResetBtn">
                        <i class="fas fa-undo"></i> 초기화
                    </button>
                </div>

                <div class="controls">
                    <button class="btn btn-success" id="addProductBtn">
                        <i class="fas fa-plus"></i> 제품 추가
                    </button>
                    <button class="btn btn-primary" id="downloadProductSampleBtn">
                        <i class="fas fa-download"></i> Excel 샘플
                    </button>
                    <button class="btn btn-warning" id="uploadProductBtn">
                        <i class="fas fa-upload"></i> Excel 업로드
                    </button>
                    <button class="btn btn-danger" id="deleteAllProductsBtn">
                        <i class="fas fa-trash-alt"></i> 전체 삭제
                    </button>
                </div>

                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th><input type="checkbox" class="checkbox" id="selectAllProducts"></th>
                                <th>차수</th>
                                <th>관리번호</th>
                                <th>제품명</th>
                                <th>시리얼</th>
                                <th>작업</th>
                            </tr>
                        </thead>
                        <tbody id="productTableBody"></tbody>
                    </table>
                </div>

                <div class="pagination">
                    <button class="pagination-btn" id="prevProductPage">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <input type="number" class="pagination-input" id="currentProductPage" value="1" min="1">
                    <span class="pagination-info">/ <span id="totalProductPages">1</span></span>
                    <button class="pagination-btn" id="nextProductPage">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>

            <!-- 사용자 관리 페이지 -->
            <div id="usersPage" class="page-content hidden">
                <div class="controls">
                    <button class="btn btn-success" id="addUserBtn">
                        <i class="fas fa-user-plus"></i> 사용자 추가
                    </button>
                </div>

                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>사용자명</th>
                                <th>권한</th>
                                <th>생성일</th>
                                <th>작업</th>
                            </tr>
                        </thead>
                        <tbody id="userTableBody">
                            <tr>
                                <td>admin</td>
                                <td><span class="status-badge rental">최고관리자</span></td>
                                <td>2024-01-01</td>
                                <td>
                                    <button class="btn btn-sm btn-primary" onclick="editUser('admin')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-sm btn-danger" onclick="deleteUser('admin')" disabled>
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 피드백 게시판 페이지 -->
            <div id="feedbackPage" class="page-content hidden">
                <div class="controls">
                    <button class="btn btn-success" id="addFeedbackBtn">
                        <i class="fas fa-plus"></i> 새 글 작성
                    </button>
                    <input type="text" class="search-input" id="feedbackSearchInput" placeholder="제목, 내용으로 검색...">
                    <button class="btn btn-primary" id="feedbackSearchBtn">
                        <i class="fas fa-search"></i> 검색
                    </button>
                </div>

                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>번호</th>
                                <th>제목</th>
                                <th>작성자</th>
                                <th>작성일</th>
                                <th>조회수</th>
                                <th>작업</th>
                            </tr>
                        </thead>
                        <tbody id="feedbackTableBody"></tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <!-- 프로그레스 바 -->
    <div class="progress-container" id="progressContainer">
        <div class="progress-content">
            <div class="progress-text">업로드 진행 중...</div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-percentage" id="progressPercentage">0%</div>
        </div>
    </div>

    <!-- 대여 정보 수정 모달 -->
    <div class="modal" id="rentalDetailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">대여 정보 수정</h2>
                <button class="modal-close" onclick="closeModal('rentalDetailModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">관리번호</label>
                        <input type="text" class="form-input" id="editRentalNumber">
                    </div>
                    <div class="form-group">
                        <label class="form-label">제품시리얼</label>
                        <input type="text" class="form-input" id="editProductSerial">
                    </div>
                    <div class="form-group">
                        <label class="form-label">학교명</label>
                        <input type="text" class="form-input" id="editSchoolName">
                    </div>
                    <div class="form-group">
                        <label class="form-label">학교급</label>
                        <select class="form-select" id="editSchoolLevel">
                            <option value="초등학교">초등학교</option>
                            <option value="중학교">중학교</option>
                            <option value="고등학교">고등학교</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">학생명</label>
                        <input type="text" class="form-input" id="editStudentName">
                    </div>
                    <div class="form-group">
                        <label class="form-label">제품명</label>
                        <input type="text" class="form-input" id="editProductName" readonly>
                    </div>
                    <div class="form-group">
                        <label class="form-label">상태</label>
                        <select class="form-select" id="editRentalStatus">
                            <option value="대여중">대여중</option>
                            <option value="미 대여중">미 대여중</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">메모1</label>
                        <input type="text" class="form-input" id="editMemo1">
                    </div>
                    <div class="form-group">
                        <label class="form-label">메모2</label>
                        <input type="text" class="form-input" id="editMemo2">
                    </div>
                    <div class="form-group">
                        <label class="form-label">학생생년월일</label>
                        <input type="date" class="form-input" id="editStudentBirthdate">
                    </div>
                    <div class="form-group">
                        <label class="form-label">학생연락처</label>
                        <input type="text" class="form-input" id="editStudentPhone">
                    </div>
                    <div class="form-group">
                        <label class="form-label">개인정보동의일자</label>
                        <input type="date" class="form-input" id="editPrivacyAgreeDate">
                    </div>
                    <div class="form-group">
                        <label class="form-label">보호자명</label>
                        <input type="text" class="form-input" id="editGuardianName">
                    </div>
                    <div class="form-group">
                        <label class="form-label">관계</label>
                        <input type="text" class="form-input" id="editRelationship">
                    </div>
                    <div class="form-group">
                        <label class="form-label">보호자연락처</label>
                        <input type="text" class="form-input" id="editGuardianPhone">
                    </div>
                    <div class="form-group">
                        <label class="form-label">기타사항</label>
                        <textarea class="form-textarea" id="editOtherNotes"></textarea>
                    </div>
                </div>

                <h3>악세사리 관리</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-plug"></i> 충전기</label>
                        <select class="form-select" id="editChargerStatus">
                            <option value="양호">양호</option>
                            <option value="훼손">훼손</option>
                            <option value="완파">완파</option>
                            <option value="분실">분실</option>
                            <option value="초기미포함">초기미포함</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-cable-car"></i> 충전케이블</label>
                        <select class="form-select" id="editCableStatus">
                            <option value="양호">양호</option>
                            <option value="훼손">훼손</option>
                            <option value="완파">완파</option>
                            <option value="분실">분실</option>
                            <option value="초기미포함">초기미포함</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-usb"></i> USB 랜 젠더</label>
                        <select class="form-select" id="editUsbAdapterStatus">
                            <option value="양호">양호</option>
                            <option value="훼손">훼손</option>
                            <option value="완파">완파</option>
                            <option value="분실">분실</option>
                            <option value="초기미포함">초기미포함</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-mouse"></i> 마우스</label>
                        <select class="form-select" id="editMouseStatus">
                            <option value="양호">양호</option>
                            <option value="훼손">훼손</option>
                            <option value="완파">완파</option>
                            <option value="분실">분실</option>
                            <option value="초기미포함">초기미포함</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-briefcase"></i> 가방</label>
                        <select class="form-select" id="editBagStatus">
                            <option value="양호">양고</option>
                            <option value="훼손">훼손</option>
                            <option value="완파">완파</option>
                            <option value="분실">분실</option>
                            <option value="초기미포함">초기미포함</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-mobile-alt"></i> 케이스</label>
                        <select class="form-select" id="editCaseStatus">
                            <option value="양호">양호</option>
                            <option value="훼손">훼손</option>
                            <option value="완파">완파</option>
                            <option value="분실">분실</option>
                            <option value="초기미포함">초기미포함</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('rentalDetailModal')">취소</button>
                <button class="btn btn-primary" id="saveRentalBtn">저장</button>
            </div>
        </div>
    </div>

    <!-- 새 대여 추가 모달 -->
    <div class="modal" id="addRentalModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">새 대여 추가</h2>
                <button class="modal-close" onclick="closeModal('addRentalModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">관리번호</label>
                        <input type="text" class="form-input" id="newRentalNumber">
                    </div>
                    <div class="form-group">
                        <label class="form-label">제품시리얼</label>
                        <select class="form-select" id="newProductSerial">
                            <option value="">제품을 선택하세요</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">학교명</label>
                        <input type="text" class="form-input" id="newSchoolName">
                    </div>
                    <div class="form-group">
                        <label class="form-label">학교급</label>
                        <select class="form-select" id="newSchoolLevel">
                            <option value="초등학교">초등학교</option>
                            <option value="중학교">중학교</option>
                            <option value="고등학교">고등학교</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">학생명</label>
                        <input type="text" class="form-input" id="newStudentName">
                    </div>
                    <div class="form-group">
                        <label class="form-label">제품명</label>
                        <input type="text" class="form-input" id="newProductName" readonly>
                    </div>
                    <div class="form-group">
                        <label class="form-label">메모1</label>
                        <input type="text" class="form-input" id="newMemo1">
                    </div>
                    <div class="form-group">
                        <label class="form-label">메모2</label>
                        <input type="text" class="form-input" id="newMemo2">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('addRentalModal')">취소</button>
                <button class="btn btn-primary" id="saveNewRentalBtn">저장</button>
            </div>
        </div>
    </div>

    <!-- 제품 추가 모달 -->
    <div class="modal" id="addProductModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">제품 추가</h2>
                <button class="modal-close" onclick="closeModal('addProductModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">차수</label>
                        <select class="form-select" id="newProductPhase">
                            <option value="1차">1차</option>
                            <option value="2차">2차</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">관리번호</label>
                        <input type="text" class="form-input" id="newProductNumber">
                    </div>
                    <div class="form-group">
                        <label class="form-label">제품명</label>
                        <input type="text" class="form-input" id="newProductNameInput">
                    </div>
                    <div class="form-group">
                        <label class="form-label">시리얼</label>
                        <input type="text" class="form-input" id="newProductSerial">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('addProductModal')">취소</button>
                <button class="btn btn-primary" id="saveNewProductBtn">저장</button>
            </div>
        </div>
    </div>

    <!-- 사용자 추가 모달 -->
    <div class="modal" id="addUserModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">사용자 추가</h2>
                <button class="modal-close" onclick="closeModal('addUserModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">사용자명</label>
                    <input type="text" class="form-input" id="newUsername">
                </div>
                <div class="form-group">
                    <label class="form-label">비밀번호</label>
                    <input type="password" class="form-input" id="newUserPassword">
                </div>
                <div class="form-group">
                    <label class="form-label">권한</label>
                    <select class="form-select" id="newUserRole">
                        <option value="사용자">사용자</option>
                        <option value="관리자">관리자</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('addUserModal')">취소</button>
                <button class="btn btn-primary" id="saveNewUserBtn">저장</button>
            </div>
        </div>
    </div>

    <!-- 피드백 작성 모달 -->
    <div class="modal" id="addFeedbackModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">새 글 작성</h2>
                <button class="modal-close" onclick="closeModal('addFeedbackModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">제목</label>
                    <input type="text" class="form-input" id="newFeedbackTitle">
                </div>
                <div class="form-group">
                    <label class="form-label">내용</label>
                    <textarea class="form-textarea" id="newFeedbackContent" rows="5"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('addFeedbackModal')">취소</button>
                <button class="btn btn-primary" id="saveNewFeedbackBtn">저장</button>
            </div>
        </div>
    </div>

    <!-- 파일 업로드 인풋 -->
    <input type="file" id="excelFileInput" accept=".xlsx,.xls" style="display: none;">

    <script>
        // Firebase 설정
        const firebaseConfig = {
            apiKey: "AIzaSyBQW8SvnYg4R-1IssLlAZ5fJ4382nNztKA",
            authDomain: "jeju-education-system.firebaseapp.com",
            databaseURL: "https://jeju-education-system-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "jeju-education-system",
            storageBucket: "jeju-education-system.firebasestorage.app",
            messagingSenderId: "462514623607",
            appId: "1:462514623607:web:afa068226e4f115a4a2272"
        };

        // Firebase 초기화
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // 전역 변수
        let currentUser = null;
        let currentPage = 'dashboard';
        let rentals = [];
        let products = [];
        let users = [];
        let feedback = [];
        let currentRentalPage = 1;
        let currentProductPage = 1;
        const itemsPerPage = 20;

        // DOM 로드 후 초기화
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        // 앱 초기화
        function initializeApp() {
            setupEventListeners();
            updateCurrentTime();
            setInterval(updateCurrentTime, 1000);
            
            // 로그인 상태 확인
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showMainSystem();
                loadAllData();
            } else {
                showLoginScreen();
            }
        }

        // 이벤트 리스너 설정
        function setupEventListeners() {
            // 로그인
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            
            // 로그아웃
            document.getElementById('logoutBtn').addEventListener('click', handleLogout);
            
            // 네비게이션
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    const page = this.dataset.page;
                    switchPage(page);
                });
            });

            // 모바일 토글
            document.getElementById('mobileToggle').addEventListener('click', function() {
                document.getElementById('sidebar').classList.toggle('active');
            });

            // 대여 관리 이벤트
            document.getElementById('addRentalBtn').addEventListener('click', () => openModal('addRentalModal'));
            document.getElementById('saveNewRentalBtn').addEventListener('click', saveNewRental);
            document.getElementById('saveRentalBtn').addEventListener('click', saveRentalEdit);
            document.getElementById('downloadRentalSampleBtn').addEventListener('click', downloadRentalSample);
            document.getElementById('uploadRentalBtn').addEventListener('click', () => uploadExcel('rental'));
            document.getElementById('deleteAllRentalsBtn').addEventListener('click', deleteAllRentals);

            // 제품 관리 이벤트
            document.getElementById('addProductBtn').addEventListener('click', () => openModal('addProductModal'));
            document.getElementById('saveNewProductBtn').addEventListener('click', saveNewProduct);
            document.getElementById('downloadProductSampleBtn').addEventListener('click', downloadProductSample);
            document.getElementById('uploadProductBtn').addEventListener('click', () => uploadExcel('product'));
            document.getElementById('deleteAllProductsBtn').addEventListener('click', deleteAllProducts);

            // 사용자 관리 이벤트
            document.getElementById('addUserBtn').addEventListener('click', () => openModal('addUserModal'));
            document.getElementById('saveNewUserBtn').addEventListener('click', saveNewUser);

            // 피드백 이벤트
            document.getElementById('addFeedbackBtn').addEventListener('click', () => openModal('addFeedbackModal'));
            document.getElementById('saveNewFeedbackBtn').addEventListener('click', saveNewFeedback);

            // 검색 이벤트
            document.getElementById('searchBtn').addEventListener('click', searchRentals);
            document.getElementById('resetBtn').addEventListener('click', resetSearch);
            document.getElementById('productSearchBtn').addEventListener('click', searchProducts);
            document.getElementById('productResetBtn').addEventListener('click', resetProductSearch);

            // 페이지네이션
            document.getElementById('prevRentalPage').addEventListener('click', () => changeRentalPage(-1));
            document.getElementById('nextRentalPage').addEventListener('click', () => changeRentalPage(1));
            document.getElementById('currentRentalPage').addEventListener('change', function() {
                currentRentalPage = parseInt(this.value);
                renderRentalTable();
            });

            document.getElementById('prevProductPage').addEventListener('click', () => changeProductPage(-1));
            document.getElementById('nextProductPage').addEventListener('click', () => changeProductPage(1));
            document.getElementById('currentProductPage').addEventListener('change', function() {
                currentProductPage = parseInt(this.value);
                renderProductTable();
            });

            // 제품 시리얼 선택 시 제품명 자동 매칭
            document.getElementById('newProductSerial').addEventListener('change', function() {
                const selectedSerial = this.value;
                const product = products.find(p => p.serial === selectedSerial);
                if (product) {
                    document.getElementById('newProductName').value = product.name;
                }
            });

            document.getElementById('editProductSerial').addEventListener('change', function() {
                const selectedSerial = this.value;
                const product = products.find(p => p.serial === selectedSerial);
                if (product) {
                    document.getElementById('editProductName').value = product.name;
                }
            });

            // 파일 업로드 이벤트
            document.getElementById('excelFileInput').addEventListener('change', handleFileUpload);
        }

        // 로그인 처리
        function handleLogin(e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            // 간단한 로그인 검증
            if (username === 'admin' && password === 'admin123') {
                currentUser = { username: 'admin', role: '최고관리자' };
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                showMainSystem();
                loadAllData();
                showAlert('로그인 성공!', 'success');
            } else {
                showAlert('아이디 또는 비밀번호가 올바르지 않습니다.', 'error');
            }
        }

        // 로그아웃 처리
        function handleLogout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            showLoginScreen();
            showAlert('로그아웃 되었습니다.', 'success');
        }

        // 로그인 화면 표시
        function showLoginScreen() {
            document.getElementById('loginContainer').style.display = 'flex';
            document.getElementById('mainContainer').style.display = 'none';
        }

        // 메인 시스템 표시
        function showMainSystem() {
            document.getElementById('loginContainer').style.display = 'none';
            document.getElementById('mainContainer').style.display = 'block';
            updateUserInfo();
        }

        // 사용자 정보 업데이트
        function updateUserInfo() {
            if (currentUser) {
                document.getElementById('userInfo').innerHTML = 
                    `${currentUser.role}님 환영합니다! | <span id="currentTime"></span>`;
            }
        }

        // 현재 시간 업데이트
        function updateCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleString('ko-KR');
            const timeElement = document.getElementById('currentTime');
            if (timeElement) {
                timeElement.textContent = timeString;
            }
        }

        // 페이지 전환
        function switchPage(page) {
            // 이전 활성 메뉴 제거
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });

            // 새 메뉴 활성화
            document.querySelector(`[data-page="${page}"]`).classList.add('active');

            // 모든 페이지 숨기기
            document.querySelectorAll('.page-content').forEach(content => {
                content.classList.add('hidden');
            });

            // 선택된 페이지 표시
            let pageElement, pageTitle;
            switch(page) {
                case 'dashboard':
                    pageElement = document.getElementById('dashboardPage');
                    pageTitle = '대여 관리';
                    break;
                case 'products':
                    pageElement = document.getElementById('productsPage');
                    pageTitle = '제품 관리';
                    break;
                case 'users':
                    pageElement = document.getElementById('usersPage');
                    pageTitle = '사용자 관리';
                    break;
                case 'feedback':
                    pageElement = document.getElementById('feedbackPage');
                    pageTitle = '피드백 게시판';
                    break;
            }

            if (pageElement) {
                pageElement.classList.remove('hidden');
                document.getElementById('pageTitle').textContent = pageTitle;
                currentPage = page;
            }

            // 모바일에서 사이드바 닫기
            document.getElementById('sidebar').classList.remove('active');
        }

        // 모든 데이터 로드
        async function loadAllData() {
            try {
                await Promise.all([
                    loadRentals(),
                    loadProducts(),
                    loadUsers(),
                    loadFeedback()
                ]);
                updateDashboard();
                renderAllTables();
            } catch (error) {
                console.error('데이터 로드 오류:', error);
                showAlert('데이터를 불러오는데 실패했습니다.', 'error');
            }
        }

        // 대여 데이터 로드
        async function loadRentals() {
            try {
                const snapshot = await database.ref('rentals').once('value');
                const data = snapshot.val();
                rentals = data ? Object.keys(data).map(key => ({id: key, ...data[key]})) : [];
            } catch (error) {
                console.error('대여 데이터 로드 실패:', error);
                rentals = [];
            }
        }

        // 제품 데이터 로드
        async function loadProducts() {
            try {
                const snapshot = await database.ref('products').once('value');
                const data = snapshot.val();
                products = data ? Object.keys(data).map(key => ({id: key, ...data[key]})) : [];
                updateProductSelects();
            } catch (error) {
                console.error('제품 데이터 로드 실패:', error);
                products = [];
            }
        }

        // 사용자 데이터 로드
        async function loadUsers() {
            try {
                const snapshot = await database.ref('users').once('value');
                const data = snapshot.val();
                users = data ? Object.keys(data).map(key => ({id: key, ...data[key]})) : [];
            } catch (error) {
                console.error('사용자 데이터 로드 실패:', error);
                users = [];
            }
        }

        // 피드백 데이터 로드
        async function loadFeedback() {
            try {
                const snapshot = await database.ref('feedback').once('value');
                const data = snapshot.val();
                feedback = data ? Object.keys(data).map(key => ({id: key, ...data[key]})) : [];
            } catch (error) {
                console.error('피드백 데이터 로드 실패:', error);
                feedback = [];
            }
        }

        // 대시보드 업데이트
        function updateDashboard() {
            const phase1Count = products.filter(p => p.phase === '1차').length;
            const phase2Count = products.filter(p => p.phase === '2차').length;
            const rentalCount = rentals.filter(r => r.status === '대여중').length;
            const availableCount = rentals.filter(r => r.status === '미 대여중').length;

            document.getElementById('phase1Count').textContent = phase1Count;
            document.getElementById('phase2Count').textContent = phase2Count;
            document.getElementById('rentalCount').textContent = rentalCount;
            document.getElementById('availableCount').textContent = availableCount;
        }

        // 모든 테이블 렌더링
        function renderAllTables() {
            renderRentalTable();
            renderProductTable();
            renderUserTable();
            renderFeedbackTable();
        }

        // 대여 테이블 렌더링
        function renderRentalTable() {
            const tbody = document.getElementById('rentalTableBody');
            const totalPages = Math.ceil(rentals.length / itemsPerPage);
            const startIndex = (currentRentalPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const pageRentals = rentals.slice(startIndex, endIndex);

            tbody.innerHTML = pageRentals.map((rental, index) => `
                <tr>
                    <td><input type="checkbox" class="checkbox" data-id="${rental.id}"></td>
                    <td>${startIndex + index + 1}</td>
                    <td><a href="#" class="link" onclick="openRentalDetail('${rental.id}')">${rental.managementNumber || ''}</a></td>
                    <td>${rental.productSerial || ''}</td>
                    <td>${rental.schoolName || ''}</td>
                    <td>${rental.schoolLevel || ''}</td>
                    <td>${rental.studentName || ''}</td>
                    <td>${rental.productName || ''}</td>
                    <td><span class="status-badge ${rental.status === '대여중' ? 'rental' : 'available'}">${rental.status || ''}</span></td>
                    <td>${rental.memo1 || ''}</td>
                    <td>${rental.memo2 || ''}</td>
                    <td>
                        <button class="btn btn-sm btn-primary" onclick="openRentalDetail('${rental.id}')">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="deleteRental('${rental.id}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');

            // 페이지네이션 업데이트
            document.getElementById('currentRentalPage').value = currentRentalPage;
            document.getElementById('totalRentalPages').textContent = totalPages;
            document.getElementById('prevRentalPage').disabled = currentRentalPage <= 1;
            document.getElementById('nextRentalPage').disabled = currentRentalPage >= totalPages;
        }

        // 제품 테이블 렌더링
        function renderProductTable() {
            const tbody = document.getElementById('productTableBody');
            const totalPages = Math.ceil(products.length / itemsPerPage);
            const startIndex = (currentProductPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const pageProducts = products.slice(startIndex, endIndex);

            tbody.innerHTML = pageProducts.map((product, index) => `
                <tr>
                    <td><input type="checkbox" class="checkbox" data-id="${product.id}"></td>
                    <td>${product.phase || ''}</td>
                    <td>${product.managementNumber || ''}</td>
                    <td>${product.name || ''}</td>
                    <td>${product.serial || ''}</td>
                    <td>
                        <button class="btn btn-sm btn-primary" onclick="editProduct('${product.id}')">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="deleteProduct('${product.id}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');

            // 페이지네이션 업데이트
            document.getElementById('currentProductPage').value = currentProductPage;
            document.getElementById('totalProductPages').textContent = totalPages;
            document.getElementById('prevProductPage').disabled = currentProductPage <= 1;
            document.getElementById('nextProductPage').disabled = currentProductPage >= totalPages;
        }

        // 사용자 테이블 렌더링
        function renderUserTable() {
            const tbody = document.getElementById('userTableBody');
            tbody.innerHTML = `
                <tr>
                    <td>admin</td>
                    <td><span class="status-badge rental">최고관리자</span></td>
                    <td>2024-01-01</td>
                    <td>
                        <button class="btn btn-sm btn-primary" onclick="editUser('admin')">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="deleteUser('admin')" disabled>
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            ` + users.map(user => `
                <tr>
                    <td>${user.username}</td>
                    <td><span class="status-badge available">${user.role}</span></td>
                    <td>${user.createdAt || new Date().toLocaleDateString()}</td>
                    <td>
                        <button class="btn btn-sm btn-primary" onclick="editUser('${user.id}')">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="deleteUser('${user.id}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        // 피드백 테이블 렌더링
        function renderFeedbackTable() {
            const tbody = document.getElementById('feedbackTableBody');
            tbody.innerHTML = feedback.map((item, index) => `
                <tr>
                    <td>${index + 1}</td>
                    <td><a href="#" class="link" onclick="viewFeedback('${item.id}')">${item.title}</a></td>
                    <td>${item.author}</td>
                    <td>${new Date(item.createdAt).toLocaleDateString()}</td>
                    <td>${item.views || 0}</td>
                    <td>
                        <button class="btn btn-sm btn-danger" onclick="deleteFeedback('${item.id}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        // 제품 선택 옵션 업데이트
        function updateProductSelects() {
            const selects = [
                document.getElementById('newProductSerial'),
                document.getElementById('modelFilter')
            ];

            selects.forEach(select => {
                if (select) {
                    const currentValue = select.value;
                    select.innerHTML = select.id === 'modelFilter' ? 
                        '<option value="">전체 모델</option>' : 
                        '<option value="">제품을 선택하세요</option>';
                    
                    products.forEach(product => {
                        const option = document.createElement('option');
                        option.value = product.serial;
                        option.textContent = `${product.name} (${product.serial})`;
                        select.appendChild(option);
                    });

                    select.value = currentValue;
                }
            });
        }

        // 모달 열기
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        // 모달 닫기
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // 대여 상세 정보 열기
        function openRentalDetail(rentalId) {
            const rental = rentals.find(r => r.id === rentalId);
            if (!rental) return;

            // 폼에 데이터 채우기
            document.getElementById('editRentalNumber').value = rental.managementNumber || '';
            document.getElementById('editProductSerial').value = rental.productSerial || '';
            document.getElementById('editSchoolName').value = rental.schoolName || '';
            document.getElementById('editSchoolLevel').value = rental.schoolLevel || '';
            document.getElementById('editStudentName').value = rental.studentName || '';
            document.getElementById('editProductName').value = rental.productName || '';
            document.getElementById('editRentalStatus').value = rental.status || '';
            document.getElementById('editMemo1').value = rental.memo1 || '';
            document.getElementById('editMemo2').value = rental.memo2 || '';
            document.getElementById('editStudentBirthdate').value = rental.studentBirthdate || '';
            document.getElementById('editStudentPhone').value = rental.studentPhone || '';
            document.getElementById('editPrivacyAgreeDate').value = rental.privacyAgreeDate || '';
            document.getElementById('editGuardianName').value = rental.guardianName || '';
            document.getElementById('editRelationship').value = rental.relationship || '';
            document.getElementById('editGuardianPhone').value = rental.guardianPhone || '';
            document.getElementById('editOtherNotes').value = rental.otherNotes || '';

            // 악세사리 상태
            document.getElementById('editChargerStatus').value = rental.chargerStatus || '양호';
            document.getElementById('editCableStatus').value = rental.cableStatus || '양호';
            document.getElementById('editUsbAdapterStatus').value = rental.usbAdapterStatus || '양호';
            document.getElementById('editMouseStatus').value = rental.mouseStatus || '양호';
            document.getElementById('editBagStatus').value = rental.bagStatus || '양호';
            document.getElementById('editCaseStatus').value = rental.caseStatus || '양호';

            // 저장 버튼에 ID 저장
            document.getElementById('saveRentalBtn').dataset.rentalId = rentalId;
            
            openModal('rentalDetailModal');
        }

        // 새 대여 저장
        async function saveNewRental() {
            const newRental = {
                managementNumber: document.getElementById('newRentalNumber').value,
                productSerial: document.getElementById('newProductSerial').value,
                schoolName: document.getElementById('newSchoolName').value,
                schoolLevel: document.getElementById('newSchoolLevel').value,
                studentName: document.getElementById('newStudentName').value,
                productName: document.getElementById('newProductName').value,
                status: '대여중',
                memo1: document.getElementById('newMemo1').value,
                memo2: document.getElementById('newMemo2').value,
                createdAt: new Date().toISOString()
            };

            try {
                await database.ref('rentals').push(newRental);
                await loadRentals();
                renderRentalTable();
                updateDashboard();
                closeModal('addRentalModal');
                showAlert('새 대여가 추가되었습니다.', 'success');
                
                // 폼 초기화
                document.getElementById('newRentalNumber').value = '';
                document.getElementById('newProductSerial').value = '';
                document.getElementById('newSchoolName').value = '';
                document.getElementById('newStudentName').value = '';
                document.getElementById('newProductName').value = '';
                document.getElementById('newMemo1').value = '';
                document.getElementById('newMemo2').value = '';
            } catch (error) {
                console.error('대여 추가 오류:', error);
                showAlert('대여 추가에 실패했습니다.', 'error');
            }
        }

        // 대여 정보 수정 저장
        async function saveRentalEdit() {
            const rentalId = document.getElementById('saveRentalBtn').dataset.rentalId;
            
            const updatedRental = {
                managementNumber: document.getElementById('editRentalNumber').value,
                productSerial: document.getElementById('editProductSerial').value,
                schoolName: document.getElementById('editSchoolName').value,
                schoolLevel: document.getElementById('editSchoolLevel').value,
                studentName: document.getElementById('editStudentName').value,
                productName: document.getElementById('editProductName').value,
                status: document.getElementById('editRentalStatus').value,
                memo1: document.getElementById('editMemo1').value,
                memo2: document.getElementById('editMemo2').value,
                studentBirthdate: document.getElementById('editStudentBirthdate').value,
                studentPhone: document.getElementById('editStudentPhone').value,
                privacyAgreeDate: document.getElementById('editPrivacyAgreeDate').value,
                guardianName: document.getElementById('editGuardianName').value,
                relationship: document.getElementById('editRelationship').value,
                guardianPhone: document.getElementById('editGuardianPhone').value,
                otherNotes: document.getElementById('editOtherNotes').value,
                chargerStatus: document.getElementById('editChargerStatus').value,
                cableStatus: document.getElementById('editCableStatus').value,
                usbAdapterStatus: document.getElementById('editUsbAdapterStatus').value,
                mouseStatus: document.getElementById('editMouseStatus').value,
                bagStatus: document.getElementById('editBagStatus').value,
                caseStatus: document.getElementById('editCaseStatus').value,
                updatedAt: new Date().toISOString()
            };

            try {
                await database.ref(`rentals/${rentalId}`).update(updatedRental);
                await loadRentals();
                renderRentalTable();
                updateDashboard();
                closeModal('rentalDetailModal');
                showAlert('대여 정보가 수정되었습니다.', 'success');
            } catch (error) {
                console.error('대여 수정 오류:', error);
                showAlert('대여 정보 수정에 실패했습니다.', 'error');
            }
        }

        // 새 제품 저장
        async function saveNewProduct() {
            const newProduct = {
                phase: document.getElementById('newProductPhase').value,
                managementNumber: document.getElementById('newProductNumber').value,
                name: document.getElementById('newProductNameInput').value,
                serial: document.getElementById('newProductSerial').value,
                createdAt: new Date().toISOString()
            };

            try {
                await database.ref('products').push(newProduct);
                await loadProducts();
                renderProductTable();
                updateDashboard();
                closeModal('addProductModal');
                showAlert('새 제품이 추가되었습니다.', 'success');
                
                // 폼 초기화
                document.getElementById('newProductNumber').value = '';
                document.getElementById('newProductNameInput').value = '';
                document.getElementById('newProductSerial').value = '';
            } catch (error) {
                console.error('제품 추가 오류:', error);
                showAlert('제품 추가에 실패했습니다.', 'error');
            }
        }

        // 새 사용자 저장
        async function saveNewUser() {
            const newUser = {
                username: document.getElementById('newUsername').value,
                password: document.getElementById('newUserPassword').value,
                role: document.getElementById('newUserRole').value,
                createdAt: new Date().toISOString()
            };

            try {
                await database.ref('users').push(newUser);
                await loadUsers();
                renderUserTable();
                closeModal('addUserModal');
                showAlert('새 사용자가 추가되었습니다.', 'success');
                
                // 폼 초기화
                document.getElementById('newUsername').value = '';
                document.getElementById('newUserPassword').value = '';
                document.getElementById('newUserRole').value = '사용자';
            } catch (error) {
                console.error('사용자 추가 오류:', error);
                showAlert('사용자 추가에 실패했습니다.', 'error');
            }
        }

        // 새 피드백 저장
        async function saveNewFeedback() {
            const newFeedback = {
                title: document.getElementById('newFeedbackTitle').value,
                content: document.getElementById('newFeedbackContent').value,
                author: currentUser.username,
                createdAt: new Date().toISOString(),
                views: 0
            };

            try {
                await database.ref('feedback').push(newFeedback);
                await loadFeedback();
                renderFeedbackTable();
                closeModal('addFeedbackModal');
                showAlert('새 글이 작성되었습니다.', 'success');
                
                // 폼 초기화
                document.getElementById('newFeedbackTitle').value = '';
                document.getElementById('newFeedbackContent').value = '';
            } catch (error) {
                console.error('피드백 추가 오류:', error);
                showAlert('글 작성에 실패했습니다.', 'error');
            }
        }

        // 대여 삭제
        async function deleteRental(rentalId) {
            if (!confirm('정말로 이 대여 기록을 삭제하시겠습니까?')) return;

            try {
                await database.ref(`rentals/${rentalId}`).remove();
                await loadRentals();
                renderRentalTable();
                updateDashboard();
                showAlert('대여 기록이 삭제되었습니다.', 'success');
            } catch (error) {
                console.error('대여 삭제 오류:', error);
                showAlert('대여 기록 삭제에 실패했습니다.', 'error');
            }
        }

        // 제품 삭제
        async function deleteProduct(productId) {
            if (!confirm('정말로 이 제품을 삭제하시겠습니까?')) return;

            try {
                await database.ref(`products/${productId}`).remove();
                await loadProducts();
                renderProductTable();
                updateDashboard();
                showAlert('제품이 삭제되었습니다.', 'success');
            } catch (error) {
                console.error('제품 삭제 오류:', error);
                showAlert('제품 삭제에 실패했습니다.', 'error');
            }
        }

        // 전체 대여 삭제
        async function deleteAllRentals() {
            if (!confirm('정말로 모든 대여 기록을 삭제하시겠습니까?\n이 작업은 되돌릴 수 없습니다.')) return;

            try {
                await database.ref('rentals').remove();
                await loadRentals();
                renderRentalTable();
                updateDashboard();
                showAlert('모든 대여 기록이 삭제되었습니다.', 'success');
            } catch (error) {
                console.error('전체 대여 삭제 오류:', error);
                showAlert('전체 대여 삭제에 실패했습니다.', 'error');
            }
        }

        // 전체 제품 삭제
        async function deleteAllProducts() {
            if (!confirm('정말로 모든 제품을 삭제하시겠습니까?\n이 작업은 되돌릴 수 없습니다.')) return;

            try {
                await database.ref('products').remove();
                await loadProducts();
                renderProductTable();
                updateDashboard();
                showAlert('모든 제품이 삭제되었습니다.', 'success');
            } catch (error) {
                console.error('전체 제품 삭제 오류:', error);
                showAlert('전체 제품 삭제에 실패했습니다.', 'error');
            }
        }

        // 페이지 변경
        function changeRentalPage(direction) {
            const totalPages = Math.ceil(rentals.length / itemsPerPage);
            const newPage = currentRentalPage + direction;
            
            if (newPage >= 1 && newPage <= totalPages) {
                currentRentalPage = newPage;
                renderRentalTable();
            }
        }

        function changeProductPage(direction) {
            const totalPages = Math.ceil(products.length / itemsPerPage);
            const newPage = currentProductPage + direction;
            
            if (newPage >= 1 && newPage <= totalPages) {
                currentProductPage = newPage;
                renderProductTable();
            }
        }

        // 검색 기능
        function searchRentals() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;
            const phaseFilter = document.getElementById('phaseFilter').value;
            const modelFilter = document.getElementById('modelFilter').value;
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;

            let filteredRentals = [...rentals];

            if (searchTerm) {
                filteredRentals = filteredRentals.filter(rental => 
                    (rental.managementNumber && rental.managementNumber.toLowerCase().includes(searchTerm)) ||
                    (rental.schoolName && rental.schoolName.toLowerCase().includes(searchTerm)) ||
                    (rental.studentName && rental.studentName.toLowerCase().includes(searchTerm)) ||
                    (rental.productName && rental.productName.toLowerCase().includes(searchTerm))
                );
            }

            if (statusFilter) {
                filteredRentals = filteredRentals.filter(rental => rental.status === statusFilter);
            }

            if (phaseFilter) {
                filteredRentals = filteredRentals.filter(rental => {
                    const product = products.find(p => p.serial === rental.productSerial);
                    return product && product.phase === phaseFilter;
                });
            }

            if (modelFilter) {
                filteredRentals = filteredRentals.filter(rental => rental.productSerial === modelFilter);
            }

            if (startDate) {
                filteredRentals = filteredRentals.filter(rental => 
                    rental.privacyAgreeDate && rental.privacyAgreeDate >= startDate
                );
            }

            if (endDate) {
                filteredRentals = filteredRentals.filter(rental => 
                    rental.privacyAgreeDate && rental.privacyAgreeDate <= endDate
                );
            }

            rentals = filteredRentals;
            currentRentalPage = 1;
            renderRentalTable();
        }

        function resetSearch() {
            document.getElementById('searchInput').value = '';
            document.getElementById('statusFilter').value = '';
            document.getElementById('phaseFilter').value = '';
            document.getElementById('modelFilter').value = '';
            document.getElementById('startDate').value = '';
            document.getElementById('endDate').value = '';
            
            loadRentals().then(() => {
                currentRentalPage = 1;
                renderRentalTable();
            });
        }

        function searchProducts() {
            const searchTerm = document.getElementById('productSearchInput').value.toLowerCase();
            
            let filteredProducts = [...products];

            if (searchTerm) {
                filteredProducts = filteredProducts.filter(product => 
                    (product.phase && product.phase.toLowerCase().includes(searchTerm)) ||
                    (product.managementNumber && product.managementNumber.toLowerCase().includes(searchTerm)) ||
                    (product.name && product.name.toLowerCase().includes(searchTerm)) ||
                    (product.serial && product.serial.toLowerCase().includes(searchTerm))
                );
            }

            products = filteredProducts;
            currentProductPage = 1;
            renderProductTable();
        }

        function resetProductSearch() {
            document.getElementById('productSearchInput').value = '';
            
            loadProducts().then(() => {
                currentProductPage = 1;
                renderProductTable();
            });
        }

        // Excel 샘플 다운로드
        function downloadRentalSample() {
            const sampleData = [
                ['순번', '관리번호', '제품시리얼', '학교명', '학교급', '학생명', '상태', '메모1', '메모2', '학생생년월일', '학생연락처', '개인정보동의일자', '보호자명', '관계', '보호자연락처', '기타사항'],
                ['1', '2025-0001', 'SAMPLE001', '제주초등학교', '초등학교', '홍길동', '대여중', '정상', '양호', '20120101', '010-1234-5678', '20240101', '홍아버지', '부모', '010-9876-5432', '특이사항 없음']
            ];

            const ws = XLSX.utils.aoa_to_sheet(sampleData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, '대여관리샘플');
            XLSX.writeFile(wb, '대여관리_업로드_샘플.xlsx');
        }

        function downloadProductSample() {
            const sampleData = [
                ['차수', '관리번호', '제품명', '시리얼'],
                ['1차', '2025-0001', '삼성 노트북', 'SAMPLE001'],
                ['2차', '2025-0002', 'LG 태블릿', 'SAMPLE002']
            ];

            const ws = XLSX.utils.aoa_to_sheet(sampleData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, '제품관리샘플');
            XLSX.writeFile(wb, '제품관리_업로드_샘플.xlsx');
        }

        // Excel 업로드
        function uploadExcel(type) {
            const fileInput = document.getElementById('excelFileInput');
            fileInput.dataset.uploadType = type;
            fileInput.click();
        }

        // 파일 업로드 처리
        async function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const uploadType = event.target.dataset.uploadType;
            
            // 프로그레스 바 표시
            showProgress();

            try {
                const data = await readExcelFile(file);
                await processUploadData(data, uploadType);
                hideProgress();
                showAlert('파일 업로드가 완료되었습니다.', 'success');
            } catch (error) {
                hideProgress();
                console.error('파일 업로드 오류:', error);
                showAlert('파일 업로드에 실패했습니다.', 'error');
            }

            // 파일 입력 초기화
            event.target.value = '';
        }

        // Excel 파일 읽기
        function readExcelFile(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const data = new Uint8Array(e.target.result);
                        const workbook = XLSX.read(data, {type: 'array'});
                        const firstSheetName = workbook.SheetNames[0];
                        const worksheet = workbook.Sheets[firstSheetName];
                        const jsonData = XLSX.utils.sheet_to_json(worksheet, {header: 1});
                        resolve(jsonData);
                    } catch (error) {
                        reject(error);
                    }
                };
                reader.onerror = reject;
                reader.readAsArrayBuffer(file);
            });
        }

        // 업로드 데이터 처리
        async function processUploadData(data, type) {
            if (data.length < 2) {
                throw new Error('파일에 데이터가 없습니다.');
            }

            const headers = data[0];
            const rows = data.slice(1);
            const totalRows = rows.length;

            for (let i = 0; i < rows.length; i++) {
                const row = rows[i];
                const percentage = Math.round(((i + 1) / totalRows) * 100);
                updateProgress(percentage, `처리 중... (${i + 1}/${totalRows})`);

                if (type === 'product') {
                    await saveProductFromRow(headers, row);
                } else if (type === 'rental') {
                    await saveRentalFromRow(headers, row);
                }

                // 진행률 업데이트를 위한 약간의 지연
                await new Promise(resolve => setTimeout(resolve, 50));
            }

            // 데이터 다시 로드
            await loadAllData();
        }

        // 제품 행 데이터 저장
        async function saveProductFromRow(headers, row) {
            const product = {};
            headers.forEach((header, index) => {
                switch(header) {
                    case '차수': product.phase = row[index]; break;
                    case '관리번호': product.managementNumber = row[index]; break;
                    case '제품명': product.name = row[index]; break;
                    case '시리얼': product.serial = row[index]; break;
                }
            });

            product.createdAt = new Date().toISOString();
            await database.ref('products').push(product);
        }

        // 대여 행 데이터 저장
        async function saveRentalFromRow(headers, row) {
            const rental = {};
            headers.forEach((header, index) => {
                switch(header) {
                    case '순번': break; // 순번은 자동 생성
                    case '관리번호': rental.managementNumber = row[index]; break;
                    case '제품시리얼': rental.productSerial = row[index]; break;
                    case '학교명': rental.schoolName = row[index]; break;
                    case '학교급': rental.schoolLevel = row[index]; break;
                    case '학생명': rental.studentName = row[index]; break;
                    case '상태': rental.status = row[index] || '대여중'; break;
                    case '메모1': rental.memo1 = row[index]; break;
                    case '메모2': rental.memo2 = row[index]; break;
                    case '학생생년월일': rental.studentBirthdate = row[index]; break;
                    case '학생연락처': rental.studentPhone = row[index]; break;
                    case '개인정보동의일자': rental.privacyAgreeDate = row[index]; break;
                    case '보호자명': rental.guardianName = row[index]; break;
                    case '관계': rental.relationship = row[index]; break;
                    case '보호자연락처': rental.guardianPhone = row[index]; break;
                    case '기타사항': rental.otherNotes = row[index]; break;
                }
            });

            // 제품명 자동 매칭
            if (rental.productSerial) {
                const product = products.find(p => p.serial === rental.productSerial);
                if (product) {
                    rental.productName = product.name;
                }
            }

            rental.createdAt = new Date().toISOString();
            await database.ref('rentals').push(rental);
        }

        // 프로그레스 바 표시
        function showProgress() {
            document.getElementById('progressContainer').style.display = 'flex';
            updateProgress(0, '업로드 준비 중...');
        }

        // 프로그레스 바 업데이트
        function updateProgress(percentage, text) {
            document.getElementById('progressFill').style.width = `${percentage}%`;
            document.getElementById('progressPercentage').textContent = `${percentage}%`;
            document.querySelector('.progress-text').textContent = text;
        }

        // 프로그레스 바 숨기기
        function hideProgress() {
            document.getElementById('progressContainer').style.display = 'none';
        }

        // 알림 표시
        function showAlert(message, type = 'success') {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            alertDiv.textContent = message;
            alertDiv.style.position = 'fixed';
            alertDiv.style.top = '20px';
            alertDiv.style.right = '20px';
            alertDiv.style.zIndex = '9999';
            alertDiv.style.minWidth = '300px';
            
            document.body.appendChild(alertDiv);
            
            setTimeout(() => {
                alertDiv.remove();
            }, 3000);
        }

        // 클릭 이벤트 외부에서 모달 닫기
        window.addEventListener('click', function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        });

        // ESC 키로 모달 닫기
        window.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const modals = document.querySelectorAll('.modal');
                modals.forEach(modal => {
                    if (modal.style.display === 'block') {
                        modal.style.display = 'none';
                    }
                });
            }
        });
    </script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"954a6042fe5dd538","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"version":"2025.6.2","token":"4edd5f8ec12a48cfa682ab8261b80a79"}' crossorigin="anonymous"></script>
</body>
</html>
    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDrNLyg%2F7%2BIc9LCtwcCxmrP3cfECF736wux1xaJRt0mj3bx%2BTLQF5ZIexHyX1TJ91PmHrhW6wKZkjjmGaH95z6yViWmqX32vNTtH%2Fa4IkSCuAneihz08jienrE10PY%2B8Lgl8MIqwpJKjKtQ%2FbiuIyjSIpFIzpRVBwhADiUCUql9Y6VSBFrNCqusYlJeSVDXP3x%2FfSbm8SWTYReWmXbnkxUQZkdDkle5N5Qge%2FwUK4YzxH%2BVDFZTAntXFF8cluypgzbORhBstr3fwnIAK6XlSzgyzfNrhWRsmBH4uR1GS2ZrnPH%2F0%2FchdS4DNe5yhXxYXkGmNYeR2D8nf4iIRpKPNFXSzd5fMUmFJQi0%2FTyH%2B9WXrJN4v4v7%2FgpRtvwbWeYaoU6jSjVz6ahuooRB2fpivUCqEn3ytfCD72EntSmUVsDe3UIesOcLfejzwZ3mwR%2BWxq8KKOTUsWpxsJFeYXftARufbQ96OjoPEip9ZLBV1hLDHjAmmrfAY2YNPAyG6lYwFPV%2Bpn4Ro3jatrMNyAxGpBq%2Fk%3D";
        window.__genspark_locale = "ko-KR";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDrNLyg/7+Ic9LCtwcCxmrP3cfECF736wux1xaJRt0mj3bx+TLQF5ZIexHyX1TJ91PmHrhW6wKZkjjmGaH95z6yViWmqX32vNTtH/a4IkSCuAneihz08jienrE10PY+8Lgl8MIqwpJKjKtQ/biuIyjSIpFIzpRVBwhADiUCUql9Y6VSBFrNCqusYlJeSVDXP3x/fSbm8SWTYReWmXbnkxUQZkdDkle5N5Qge/wUK4YzxH+VDFZTAntXFF8cluypgzbORhBstr3fwnIAK6XlSzgyzfNrhWRsmBH4uR1GS2ZrnPH/0/chdS4DNe5yhXxYXkGmNYeR2D8nf4iIRpKPNFXSzd5fMUmFJQi0/TyH+9WXrJN4v4v7/gpRtvwbWeYaoU6jSjVz6ahuooRB2fpivUCqEn3ytfCD72EntSmUVsDe3UIesOcLfejzwZ3mwR+Wxq8KKOTUsWpxsJFeYXftARufbQ96OjoPEip9ZLBV1hLDHjAmmrfAY2YNPAyG6lYwFPV+pn4Ro3jatrMNyAxGpBq/k=";
    </script>
    
    <script id="html_notice_dialog_script" src="https://www.genspark.ai/notice_dialog.js"></script>
    
